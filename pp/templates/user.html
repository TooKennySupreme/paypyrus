{% extends 'navbar.html' %}
{% set thispage='login' %}
{% block content %}
<div class="user-page">
    <h1 style="margin-bottom: 75px;">Hi {{ full_name }},</h1>
	<div class="row">
		<div class="col s4 btn-col">
			<a class="btn-large btn-monies green" id="btn-qty-1">$1</a>
			<div class="input-field">
	          <input id="quantity_1" type="number" class="validate">
	          <label for="quantity_1">quantity</label>
	        </div>
		</div>
		<div class="col s4 btn-col">
			<a class="btn-large btn-monies green" id="btn-qty-5">$5</a>
			<div class="input-field">
	          <input id="quantity_5" type="number" class="validate">
	          <label for="quantity_5">quantity</label>
	        </div>
        </div>
        <div class="col s4 btn-col">
			<a class="btn-large btn-monies green" id="btn-qty-10">$10</a>
			<div class="input-field">
	          <input id="quantity_10" type="number" class="validate">
	          <label for="quantity_10">quantity</label>
	        </div>
        </div>
	</div>
    <button type="submit" id="submit-monies" class="btn-large btn-submit green lighten-1">Submit</button>
    <div class="status green-text"></div>
</div>
{% endblock %}

{% block script %}
<script type="text/javascript">
	$('#btn-qty-1').click(function () {
		$('#quantity_1').focus();
	});
	$('#btn-qty-5').click(function () {
		$('#quantity_5').focus();
	});
	$('#btn-qty-10').click(function () {
		$('#quantity_10').focus();
	});
	$('#submit-monies').click(function () {
        $(".status").addClass("darken-3");
        $(".status").html("<i class='material-icons'>flight_land</i> Loading your papyrus(es)...");

		$.ajax({
			url: "/api/v1/get_bill",
			data: {
				quantity_1: $('#quantity_1').val(),
				quantity_5: $('#quantity_5').val(),
				quantity_10: $('#quantity_10').val()
			},
			method: 'POST',
			error: function(xhr, status, error) {
				console.log(xhr);
				console.log(error);
			},
			success: function(data, status, xhr) {
                $(".status").removeClass("darken-3");
				console.log(data);
                if (data.length > 0) {
                    $(".status").html("Your bills have been created! <a target='_blank' href='/print/"+data+"'>  <i class='material-icons'>local_printshop</i></a>");
                }
			}
		});
	});
</script>
{% endblock %}
